<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard | MediCore</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <style>
    body { background-color: #f8f9fa; font-family: Arial, sans-serif; }
    .header { background-color: #0d6b3b; color: white; padding: 20px; }
    .section-title { color: #0d6b3b; margin-top: 40px; font-weight: 700; }
    .btn-green { background-color: #0d6b3b; color: white; }
    .btn-green:hover { background-color: #09964c; }
    table { background: white; border-radius: 10px; }
  </style>
</head>
<body>
  <div class="header d-flex justify-content-between align-items-center">
    <h3>Welcome Admin</h3>
      <div class="d-flex gap-3">
       <div> 
    <form class="d-flex flex" method="get" action="{{ url_for('admin_dashboard') }}">
      <input type="text" class="form-control me-2" name="search" value="{{ search_query }}" placeholder="Search Doctors/Patients/Appointments">
    
      <div><button class="btn btn-light me-2">Search</button></div>
       </form>
       </div>
      <div>
         <a href="{{ url_for('home') }}" class="btn btn-warning me-2">LOGOUT</a>
    </div>
      </div>
   
  </div>

  <div class="container mt-4">

    <!-- Registered Doctors -->
    <h4 class="section-title">Registered Doctors</h4>
    <button class="btn btn-green mb-3" data-bs-toggle="modal" data-bs-target="#addDoctorModal">+ Create Doctor</button>
    <table class="table table-bordered">
      <thead class="table-success">
        <tr>
          <th>ID</th>
          <th>Full Name</th>
           <th>Password</th>
          <th>Department</th>
          <th>Experience</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for doctor in doctors %}
        <tr>
          <td>{{ doctor[0] }}</td>
          <td>{{ doctor[2] }}</td>
          <td>{{ doctor[3] }}</td>
          <td>{{ doctor[4] }}</td>
           <td>{{ doctor[5] }}</td>
          <td>
            <button class="btn btn-warning btn-sm" 
                    data-bs-toggle="modal" 
                    data-bs-target="#editDoctorModal"
                    data-id="{{ doctor[0] }}"
                    data-name="{{ doctor[2] }}"
                    data-password="{{ doctor[3] }}"
                    data-department="{{ doctor[4] }}"
                    data-experience="{{ doctor[5] }}">Edit</button>
            <form method="POST" action="{{ url_for('delete_doctor', doctor_id=doctor[0]) }}" style="display:inline;">
              <button type="submit" class="btn btn-danger btn-sm">Delete</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <!-- Registered Patients -->
   <h4 class="section-title">Registered Patients</h4>
<table class="table table-bordered">
  <thead class="table-success">
    <tr>
      <th>ID</th>
      <th>Full Name</th>
      <th>Email</th>
      <th>Username</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for p in patients %}
    <tr>
      <td>{{ p[0] }}</td>
      <td>{{ p[1] }} {{ p[2] }}</td>
      <td>{{ p[3] }}</td>
      <td>{{ p[4] }}</td>

      <td>
        <form method="POST" action="{{ url_for('delete_patient', user_id=p[0]) }}"
 style="display:inline;">
          <button type="submit" class="btn btn-danger btn-sm">Delete</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

    <!-- Appointments -->
    <h4 class="section-title">Upcoming Appointments</h4>
    <table class="table table-bordered">
      <thead class="table-success">
        <tr>
          <th>ID</th>
          <th>Patient</th>
          <th>Doctor</th>
          <th>Date</th>
          <th>Time</th>
          <th>Department</th>
        </tr>
      </thead>
      <tbody>
        {% for appt in appointments %}
        <tr>
          <td>{{ appt[0] }}</td>
          <td>{{ appt[1] }}</td>
          <td>{{ appt[2] }}</td>
          <td>{{ appt[3] }}</td>
          <td>{{ appt[4] }}</td>
          <td>{{ appt[5] }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Add Doctor Modal -->
  <div class="modal fade" id="addDoctorModal" tabindex="-1">
    <div class="modal-dialog">
      <form class="modal-content" method="POST" action="{{ url_for('add_doctor') }}">
        <div class="modal-header">
          <h5 class="modal-title">Add New Doctor</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label>Full Name</label>
            <input type="text" name="fullname" class="form-control" required>
          </div>
          <div class="mb-3">
            <label>Password</label>
            <input type="text" name="password" class="form-control" required>
          </div>
          <div class="mb-3">
            <label>Department</label>
            <input type="text" name="department" class="form-control" required>
          </div>
          <div class="mb-3">
            <label>Experience</label>
            <input type="text" name="experience" class="form-control" required>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-green">Add Doctor</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Edit Doctor Modal -->
  <div class="modal fade" id="editDoctorModal" tabindex="-1">
    <div class="modal-dialog">
      <form id="editDoctorForm" class="modal-content" method="POST">
        <div class="modal-header">
          <h5 class="modal-title">Edit Doctor</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label>Full Name</label>
            <input type="text" name="fullname" id="editFullname" class="form-control" required>
          </div>
          <div class="mb-3">
            <label>Password</label>
            <input type="text" name="password" id="editPassword" class="form-control" required>
          </div>
          <div class="mb-3">
            <label>Department</label>
            <input type="text" name="department" id="editDepartment" class="form-control" required>
          </div>
          <div class="mb-3">
            <label>Experience</label>
            <input type="text" name="experience" id="editExperience" class="form-control" required>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-green">Save Changes</button>
        </div>
      </form>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const editDoctorModal = document.getElementById('editDoctorModal')
    editDoctorModal.addEventListener('show.bs.modal', event => {
      const button = event.relatedTarget
      const id = button.getAttribute('data-id')
      const name = button.getAttribute('data-name')
      const password = button.getAttribute('data-password')
      const dept = button.getAttribute('data-department')
      const exp = button.getAttribute('data-experience')

      document.getElementById('editFullname').value = name
      document.getElementById('editPassword').value = password
      document.getElementById('editDepartment').value = dept
      document.getElementById('editExperience').value = exp
      document.getElementById('editDoctorForm').action = `/edit_doctor/${id}`
    })
  </script>
</body>
</html>
